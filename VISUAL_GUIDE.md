# U-Net Mining Detection - Visual Overview & Execution Flow

## ğŸ¬ Complete Pipeline Visualization

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SATELLITE IMAGE DATA                         â”‚
â”‚        chingola_Before_2016.tif (5567Ã—3230, 5 bands)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  VECTOR LABELS (GeoJSON)                        â”‚
â”‚      chingola_mines.geojson (8 mining polygons)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
         â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
         â”‚                               â”‚
         â–¼                               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  CELL 1: Rasterize   â”‚      â”‚  CELL 2: Visualize â”‚
    â”‚  Vectorâ†’Raster Mask  â”‚      â”‚  & Validate        â”‚
    â”‚  (30 seconds)        â”‚      â”‚  (10 seconds)      â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                               â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚ chingola_mask.tif CREATED    â”‚
           â”‚ 5567Ã—3230 pixels, binary     â”‚
           â”‚ (0=background, 1=mine)       â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚  CELL 5: Initialize U-Net    â”‚
           â”‚  Model (10 seconds)          â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚  CELL 6: Prepare Data        â”‚
           â”‚  - Load image & mask         â”‚
           â”‚  - Create patches (500+)     â”‚
           â”‚  - Augmentation              â”‚
           â”‚  - Train/Val split (80/20)   â”‚
           â”‚  (2-3 minutes)               â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚   CELL 7: TRAIN U-NET        â”‚
           â”‚  â­ Main training loop       â”‚
           â”‚   50 epochs (or early stop)  â”‚
           â”‚  (15-30 min on GPU)          â”‚
           â”‚  (2-4 hours on CPU)          â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Model Checkpoint Saved          â”‚
        â”‚  unet_mining_detector.pt         â”‚
        â”‚  (100-150 MB)                    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Training History Plot            â”‚
        â”‚  training_history.png             â”‚
        â”‚  (Loss, IoU, Dice curves)        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  CELL 8: INFERENCE & CHANGE      â”‚
        â”‚  DETECTION (5-10 minutes)        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                      â”‚
         â–¼                      â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ 2016 Prediction  â”‚  â”‚ 2025 Prediction    â”‚
    â”‚ prediction_2016  â”‚  â”‚ prediction_2025.tifâ”‚
    â”‚ .tif (5MB)       â”‚  â”‚ (5MB)              â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                      â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  CHANGE DETECTION            â”‚
        â”‚  Compare 2016 vs 2025        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚         â”‚          â”‚
         â–¼         â–¼          â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Removed â”‚ â”‚Unchangedâ”‚ â”‚ New   â”‚
    â”‚ Mining  â”‚ â”‚ Areas  â”‚ â”‚Mining  â”‚
    â”‚ (Blue)  â”‚ â”‚(White) â”‚ â”‚(Red)   â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
         â”‚          â”‚         â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚    OUTPUT FILES:             â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚ âœ“ change_map.tif             â”‚
        â”‚ âœ“ inference_results.png      â”‚
        â”‚ âœ“ Area estimates (hectares)  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Data Flow Diagram

```
INPUT LAYER
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Satellite Image (5567Ã—3230Ã—5)  â”‚  â† 5 multispectral bands
â”‚ Ground Truth Mask (5567Ã—3230)  â”‚  â† Binary (0/1)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
PREPROCESSING
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Normalize to [0, 1]            â”‚
â”‚ Extract 256Ã—256 patches        â”‚
â”‚ Data augmentation (50% overlap) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
TRAINING DATA
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Train: 300+ patches (80%)      â”‚  â† With augmentation
â”‚ Val: 75+ patches (20%)         â”‚  â† Without augmentation
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€ Batch 1: 16 patches â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”œâ”€ Batch 2: 16 patches â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
         â”œâ”€ Batch 3: 16 patches â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â†’ U-Net Model
         â””â”€ ... (20 batches/epoch) â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
U-NET PROCESSING
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Input: (B, 5, 256, 256)        â”‚
â”‚   â†“                            â”‚
â”‚ Encoder: 5â†’64â†’128â†’256â†’512â†’1024 â”‚
â”‚   â†“                            â”‚
â”‚ Decoder: 1024â†’512â†’256â†’128â†’64   â”‚
â”‚   â†“                            â”‚
â”‚ Output: (B, 2, 256, 256)       â”‚
â”‚ [Background, Mine]             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
LOSS COMPUTATION
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Weighted CrossEntropyLoss      â”‚
â”‚ w_bg = 0.5, w_mine = 10.0     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
BACKPROPAGATION
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Adam Optimizer                 â”‚
â”‚ LR = 1e-3, Weight Decay = 1e-4 â”‚
â”‚ Update model weights           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
VALIDATION
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Compute Validation Metrics     â”‚
â”‚ - Loss                         â”‚
â”‚ - IoU (Intersection over Union)â”‚
â”‚ - Dice (F1-score)              â”‚
â”‚ Save best model                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—ï¸ U-Net Architecture

```
INPUT (B, 5, 256, 256)
        â”‚
        â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ DoubleConv  â”‚  â†’ (B, 64, 256, 256)
    â”‚ (5â†’64)      â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” SKIP 1
           â”‚                             â”‚
           â–¼                             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
    â”‚ MaxPool     â”‚                      â”‚
    â”‚ DoubleConv  â”‚  â†’ (B, 128, 128, 128)
    â”‚ (64â†’128)    â”‚                      â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                      â”‚
           â”‚                             â”‚
           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€ SKIP 2
           â”‚                             â”‚
           â–¼                             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
    â”‚ MaxPool     â”‚                      â”‚
    â”‚ DoubleConv  â”‚  â†’ (B, 256, 64, 64) â”‚
    â”‚ (128â†’256)   â”‚                      â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                      â”‚
           â”‚                             â”‚
           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€ SKIP 3
           â”‚                             â”‚
           â–¼                             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
    â”‚ MaxPool     â”‚                      â”‚
    â”‚ DoubleConv  â”‚  â†’ (B, 512, 32, 32) â”‚
    â”‚ (256â†’512)   â”‚                      â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                      â”‚
           â”‚                             â”‚
           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€ SKIP 4
           â”‚                             â”‚
           â–¼                             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
    â”‚ MaxPool     â”‚                      â”‚
    â”‚ DoubleConv  â”‚  â†’ (B, 1024, 16, 16)â”‚
    â”‚ (512â†’1024)  â”‚                      â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                      â”‚
           â”‚ BOTTLENECK                  â”‚
           â–¼                             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
    â”‚ Upsample    â”‚                      â”‚
    â”‚ Concat SKIP4â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚ DoubleConv  â”‚  â†’ (B, 512, 32, 32)
    â”‚ (1024â†’512)  â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Upsample    â”‚
    â”‚ Concat SKIP3â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â”‚ DoubleConv  â”‚  â†’ (B, 256, 64, 64)
    â”‚ (512â†’256)   â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Upsample    â”‚
    â”‚ Concat SKIP2â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â”‚ DoubleConv  â”‚  â†’ (B, 128, 128, 128)
    â”‚ (256â†’128)   â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Upsample    â”‚
    â”‚ Concat SKIP1â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â”‚ DoubleConv  â”‚  â†’ (B, 64, 256, 256)
    â”‚ (128â†’64)    â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Conv (1Ã—1)  â”‚  â†’ (B, 2, 256, 256)
    â”‚ (64â†’2)      â”‚  [Background, Mine]
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

OUTPUT (B, 2, 256, 256)
```

---

## ğŸ“ˆ Training Progress Timeline

```
EPOCH 1-5: MODEL LEARNING BASICS
â”œâ”€ Train Loss: 0.5â†’0.4
â”œâ”€ Val Loss: 0.4â†’0.35
â”œâ”€ IoU: 0.3â†’0.5
â”œâ”€ Dice: 0.4â†’0.6
â””â”€ Action: Continue training

EPOCH 5-20: MODEL IMPROVING
â”œâ”€ Train Loss: 0.4â†’0.2
â”œâ”€ Val Loss: 0.35â†’0.2
â”œâ”€ IoU: 0.5â†’0.7
â”œâ”€ Dice: 0.6â†’0.8
â””â”€ Action: Keep training

EPOCH 20-40: MODEL CONVERGENCE
â”œâ”€ Train Loss: 0.2â†’0.15
â”œâ”€ Val Loss: 0.2â†’0.18
â”œâ”€ IoU: 0.7â†’0.78
â”œâ”€ Dice: 0.8â†’0.85
â””â”€ Action: Continue training

EPOCH 40+: PLATEAU/OVERFITTING
â”œâ”€ Train Loss: ~0.15 (still decreasing)
â”œâ”€ Val Loss: ~0.18 (plateaued)
â”œâ”€ IoU: ~0.78 (plateaued)
â”œâ”€ Dice: ~0.85 (plateaued)
â””â”€ Action: Early stopping triggered
```

---

## ğŸ¯ Execution Sequence

```
PHASE 1: PREPARATION (â‰ˆ30 minutes)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ“ Install PyTorch (GPU)          â”‚
â”‚ âœ“ Install dependencies           â”‚
â”‚ âœ“ Verify data files exist        â”‚
â”‚ âœ“ Check GPU availability         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
PHASE 2: DATA VERIFICATION (â‰ˆ5 minutes)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ“ Cell 1: Create mask            â”‚
â”‚ âœ“ Cell 2: Visualize & validate   â”‚
â”‚ âœ“ Verify mask alignment          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
PHASE 3: MODEL SETUP (â‰ˆ15 seconds)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ“ Cell 5: Initialize U-Net       â”‚
â”‚ âœ“ Test forward pass              â”‚
â”‚ âœ“ Verify GPU allocation          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
PHASE 4: DATA PREPARATION (â‰ˆ3 minutes)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ“ Cell 6: Load image & mask      â”‚
â”‚ âœ“ Create patches                 â”‚
â”‚ âœ“ Setup dataloaders              â”‚
â”‚ âœ“ Compute class weights          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
PHASE 5: TRAINING (â­ 15-30 min on GPU)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ“ Cell 7: Run training loop      â”‚
â”‚ âœ“ Monitor training progress      â”‚
â”‚ âœ“ Validate every epoch           â”‚
â”‚ âœ“ Save best model                â”‚
â”‚ âœ“ Early stop if no improvement   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
PHASE 6: INFERENCE (â‰ˆ5-10 minutes)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ“ Cell 8: Load trained model     â”‚
â”‚ âœ“ Predict on 2016 image          â”‚
â”‚ âœ“ Predict on 2025 image          â”‚
â”‚ âœ“ Generate change map            â”‚
â”‚ âœ“ Create visualizations          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
TOTAL TIME: ~1-2 hours (including setup)
```

---

## ğŸ“Š Output File Sizes

```
Model & Weights
â”œâ”€ unet_mining_detector.pt      100-150 MB   (Binary file)

Predictions
â”œâ”€ prediction_2016.tif          5-10 MB      (GeoTIFF, uint8)
â”œâ”€ prediction_2025.tif          5-10 MB      (GeoTIFF, uint8)
â”œâ”€ change_map.tif               5-10 MB      (GeoTIFF, int8)

Visualizations
â”œâ”€ training_history.png         1-2 MB       (PNG image)
â”œâ”€ inference_results.png        3-5 MB       (PNG image)
â”œâ”€ mask_visualization.png       3-5 MB       (PNG image)
â”œâ”€ mask_edge_analysis.png       2-3 MB       (PNG image)

Total Output: ~140-210 MB
```

---

## ğŸ“ Key Metrics Explanation

### IoU (Intersection over Union)
```
IoU = |Predicted âˆ© Ground Truth| / |Predicted âˆª Ground Truth|

Range: 0.0 to 1.0
- 0.0 = No overlap
- 0.5 = 50% overlap
- 1.0 = Perfect prediction

Typical:
- Random: 0.3-0.4
- Untrained: 0.4-0.5
- Well-trained: 0.7-0.85
- Excellent: 0.85-0.95
```

### Dice Coefficient (F1-Score)
```
Dice = 2 * |Predicted âˆ© Ground Truth| / (|Predicted| + |Ground Truth|)

Range: 0.0 to 1.0
- 0.0 = No overlap
- 0.5 = 50% F1-score
- 1.0 = Perfect prediction

Typical:
- Random: 0.4-0.5
- Untrained: 0.5-0.6
- Well-trained: 0.8-0.9
- Excellent: 0.9-0.95
```

### Loss
```
Weighted Cross Entropy Loss

Range: 0.0 to +âˆ
- 0.0 = Perfect predictions
- 0.1-0.3 = Good predictions
- 0.3-0.5 = Acceptable
- 0.5+ = Poor predictions

Typical training:
- Epoch 1: Loss 0.5
- Epoch 10: Loss 0.3
- Epoch 30: Loss 0.15
- Epoch 50: Loss 0.12
```

---

## âœ… Success Indicators

### During Training (Cell 7)
```
âœ… GOOD SIGNS:
â””â”€ Loss decreases each epoch
â””â”€ Validation loss < Training loss
â””â”€ IoU increases over time
â””â”€ Dice increases over time
â””â”€ Early stopping after 25-40 epochs

âŒ BAD SIGNS:
â””â”€ Loss stuck or increasing
â””â”€ Val loss >> Train loss (overfitting)
â””â”€ IoU/Dice not improving
â””â”€ Training crashes
```

### Prediction Quality (Cell 8)
```
âœ… GOOD SIGNS:
â””â”€ Predictions match satellite features
â””â”€ Most mines detected (high recall)
â””â”€ Few false positives
â””â”€ Change map shows reasonable differences

âŒ BAD SIGNS:
â””â”€ Random-looking predictions
â””â”€ Lots of false positives
â””â”€ Missing obvious mines
â””â”€ Change map all zeros
```

---

## ğŸš€ Performance Optimization Tips

### For Faster Training
```
âœ“ Use GPU (CUDA)
âœ“ Reduce image size (512Ã—512 â†’ 256Ã—256)
âœ“ Reduce batch size (16 â†’ 8)
âœ“ Fewer epochs (50 â†’ 30)
âœ“ Disable augmentation (not recommended)
```

### For Better Accuracy
```
âœ“ More epochs (50 â†’ 100)
âœ“ Lower learning rate (1e-3 â†’ 5e-4)
âœ“ Stronger augmentation
âœ“ Larger batch size (if GPU memory allows)
âœ“ More training data
```

### For Stable Training
```
âœ“ Learning rate scheduling
âœ“ Batch normalization
âœ“ Early stopping
âœ“ Model checkpointing
âœ“ Gradient clipping (if needed)
```

---

## ğŸ“ Quick Troubleshooting

```
PROBLEM              â”‚ QUICK FIX
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
CUDA OOM             â”‚ Reduce BATCH_SIZE to 8
Training slow        â”‚ Check GPU: nvidia-smi
Module not found     â”‚ pip install missing_package
Poor predictions     â”‚ Check mask visualization (Cell 2)
Training crashed     â”‚ Restart kernel, reduce memory
No improvement       â”‚ Lower learning rate to 5e-4
All zeros output     â”‚ Check model loaded correctly
Path errors          â”‚ Use absolute paths
```

---

**Everything is visualized above. You're ready to execute! ğŸš€**
